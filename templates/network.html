{% extends "base.html" %}
{% block content %}

<h2>Rozšířené síťové testy</h2>

<form method="post">
  <fieldset>
    <legend>Ping testy</legend>
    <label for="targets">Zadejte IP adresy (oddělené čárkou):</label><br>
    <input type="text" name="targets" id="targets" size="60" value="{{ default_targets }}"><br>
    <button type="submit" name="action" value="ping">Spustit ping test</button>
  </fieldset>
  <br>
  <fieldset>
    <legend>iPerf3 test</legend>
    <label for="iperf_ip">IP serveru:</label>
    <input type="text" name="iperf_ip" id="iperf_ip" value="192.168.1.20">
    <label for="duration">Délka (s):</label>
    <input type="number" name="duration" id="duration" value="10" min="1" max="60">
    <button type="submit" name="action" value="iperf">Spustit iPerf test</button>
  </fieldset>
</form>

{% if ping_results %}
<h3>Výsledky ping testu</h3>
<table>
  <tr><th>Cíl</th><th>Ztráta paketů</th><th>Průměrná doba (ms)</th><th>Chyba</th></tr>
  {% for r in ping_results %}
  <tr>
    <td>{{ r.target }}</td>
    <td>{{ r.loss if r.loss is not none else '–' }}%</td>
    <td>{{ r.avg_time_ms if r.avg_time_ms is not none else '–' }}</td>
    <td>{{ r.error if r.error else '' }}</td>
  </tr>
  {% endfor %}
</table>
{% endif %}

{% if iperf_result %}
<h3>Výsledek iPerf testu</h3>
<p><strong>Server:</strong> {{ iperf_result.server }}</p>
<pre>
{% if iperf_result.error %}
Chyba: {{ iperf_result.error }}
{% else %}
{{ iperf_result.summary }}
{% endif %}
</pre>
{% endif %}

{% endblock %}
